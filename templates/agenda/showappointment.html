{% extends "app.html" %}
{% block title %} Show Appointment {% endblock %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="column" style="flex: auto;">
                <div>
                    <h2>Appointment details:</h2><br>
                </div>
                <div>
                    <label for="date">Date:</label>
                    {{ appointment.date }}
                </div>
                <div>
                    <label for="time">Time:</label>
                    {{ appointment.time }}
                </div>
                <div>
                    <label for="commune">Commune:</label>
                    {{ appointment.commune }}
                </div>
                <div>
                    <label for="address">Address:</label>
                    {{ appointment.address }}
                </div>
                <div>
                    <label for="car_brand">Car Brand:</label>
                    {{ appointment.car_brand }}
                </div>
                <div>
                    <label for="car_model">Car Model:</label>
                    {{ appointment.car_model }}
                </div>
                <div>
                    <label for="description">Description:</label>
                    {{ appointment.description }}
                </div>
                <div>
                    <label for="mech">Mechanic:</label>
                    {{ appointment.mech }}
                </div>
                <div>
                    <label for="description">Status:</label>
                    {% if appointment.completed %}Completed{% elif appointment.canceled %}Canceled{% elif appointment.confirmed %}Confirmed{% else %}Not Confirmed{% endif %}
                </div>
                <br>
                {% if user.mech_verified %}
                    {% if appointment.canceled == False and appointment.confirmed == False %}
                        <div class="btn btn-sm btn-success">
                            <a class="dropdown-item" href="/agenda/update/{{appointment.id}}/1">Confirm</a>
                        </div>
                    {% endif %}
                {% else %}
                    {% if appointment.canceled == False %}
                        <div class="btn btn-sm btn-danger">
                            <a class="dropdown-item" onclick="confirm('Cancel Appointment id {{appointment.id}}? \nCanceled Appointments cannot be recovered!')||event.stopImmediatePropagation()"
                            href="/agenda/update/{{appointment.id}}/2"><i class="fa fa-trash"></i>Cancel</a>
                        </div>
                    {% endif %}
                {% endif %}
                <div class="btn btn-sm btn-info">
                    <a class="dropdown-item" href="/agenda">Go Back</a>
                </div>
            </div>
            <div class="column" style="flex: auto;">
                <div>
                    {% if user.mech_verified %}
                        <h2>Your appointments for the day ({{ appointment.date }}):</h2><br>
                    {% else %}
                        <h2>Your appointments with this mech ({{ appointment.mech }}):</h2><br>
                    {% endif %}
                </div>
                <table class="table table-bordered table-sm">
                    <thead class="thead">
                        <tr>
                            <td>ID</td> 
                            <th>Date</th>
                            <th>Time</th>
                            <th>Commune</th>
                            <th>Address</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if appointments %}
                            {% for appointment in appointments %}
                                <tr>
                                    <td><a href="/agenda/{{appointment.id}}">{{ appointment.id }}</a></td>
                                    <td>{{ appointment.date }}</td>
                                    <td>{{ appointment.time }}</td>
                                    <td>{{ appointment.commune }}</td>
                                    <td>{{ appointment.address }}</td>
                                    <td>{% if appointment.completed %}Completed{% elif appointment.canceled %}Canceled{% elif appointment.confirmed %}Confirmed{% else %}Not Confirmed{% endif %}</td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr><td class="text-center" colspan="100%">No data found.</td></tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}